var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},__generator=this&&this.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(o){if(e)throw new TypeError("Generator is already executing.");while(f&&(f=0,o[0]&&(r=0)),r)try{if(e=1,u&&(i=o[0]&2?u["return"]:o[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,o[1])).done)return i;(u=0,i)&&(o=[o[0]&2,i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++;u=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!i||o[1]>i[0]&&o[1]<i[3])){r.label=o[1];break}if(o[0]===6&&r.label<i[1]){r.label=i[1];i=o;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(o);break}i[2]&&r.ops.pop();r.trys.pop();continue}o=t.call(n,r)}catch(s){o=[6,s];u=0}finally{e=i=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},e,u,i,f;return f={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f},SydneyFullScreenConv;(function(n){function gr(u){var f,a,p,w,d,g,rt,ut,ft,et,at,vt,pt,dt,ii,ri,oi,ci,li,ai,di,dr,gr,nu,ru,fu,eu,ou,su,hu,cu,vu,yu,pu,wu,bu,nf,tf,uf,ff,ef,sf,hf,cf,lf,af,vf,gf,ne,ie,re,ee,oe,se,he,ce,le,ae,ve,ye,pe,we,be,ke,de,ge,no,to,io,ro,uo,fo,eo,oo,so,ho;return u===void 0&&(u=null),__awaiter(this,void 0,void 0,function(){var es,os,ss,gs,nh,wo,yo,hs,bo,cs,ls,ko,po,go,ns,ts,th,as,vs,ys,ps,ws,bs,is,ks,rs,co,ao,lo,us,fs,vo,ds;return __generator(this,function(ih){switch(ih.label){case 0:return(i=_ge(lu),i.querySelector("cib-serp"))?[2]:(ui=SydFSCHelper.getConfigOrDefault((f=_w._sydConvConfig)===null||f===void 0?void 0:f.usePill,!1,!0),ot=SydFSCHelper.getConfigOrDefault((a=_w._sydConvConfig)===null||a===void 0?void 0:a.enableScrollOut,!1,!0),fi=SydFSCHelper.getConfigOrDefault((p=_w._sydConvConfig)===null||p===void 0?void 0:p.enableSydContext,!1,!0),h=SydFSCHelper.getConfigOrDefault((w=_w._sydConvConfig)===null||w===void 0?void 0:w.convBackBtn,!1),st=SydFSCHelper.getConfigOrDefault((d=_w._sydConvConfig)===null||d===void 0?void 0:d.enableSetConvQueryFlag,!1,!0),ku=SydFSCHelper.getConfigOrDefault((g=_w._sydConvConfig)===null||g===void 0?void 0:g.enableSydTigerAns,!1,!0),vi=SydFSCHelper.getConfigOrDefault((rt=_w._sydConvConfig)===null||rt===void 0?void 0:rt.enableSydAjax,!1),yt=SydFSCHelper.getConfigOrDefault((ut=_w._sydConvConfig)===null||ut===void 0?void 0:ut.enableSydCarousel,!1),n.moveOnlySydXAnswers=SydFSCHelper.getConfigOrDefault((ft=_w._sydConvConfig)===null||ft===void 0?void 0:ft.moveOnlySydXAnswers,!1,!0),c=SydFSCHelper.getConfigOrDefault((et=_w._sydConvConfig)===null||et===void 0?void 0:et.hideSydFSC,!1),l=SydFSCHelper.getConfigOrDefault((at=_w._sydConvConfig)===null||at===void 0?void 0:at.enableSydOverlay,!1),ei=SydFSCHelper.getConfigOrDefault((vt=_w._sydConvConfig)===null||vt===void 0?void 0:vt.enable1TCibSlot,!1),nt=SydFSCHelper.getConfigOrDefault((pt=_w._sydConvConfig)===null||pt===void 0?void 0:pt.enableSydX1T,!1,!0),pi=SydFSCHelper.getConfigOrDefault((dt=_w._sydConvConfig)===null||dt===void 0?void 0:dt.hideSydMic,!1),wi=SydFSCHelper.getConfigOrDefault((ii=_w._sydConvConfig)===null||ii===void 0?void 0:ii.fromNoResults,!1),ur=SydFSCHelper.getConfigOrDefault((ri=_w._sydConvConfig)===null||ri===void 0?void 0:ri.codexWinEnableCustomGreeting,!1),fr=SydFSCHelper.getConfigOrDefault((oi=_w._sydConvConfig)===null||oi===void 0?void 0:oi.codexWinGreetingCustomString,""),gi=SydFSCHelper.getConfigOrDefault((ci=_w._sydConvConfig)===null||ci===void 0?void 0:ci.checkCreatorAnsFor1T,!1,!0),bi=SydFSCHelper.getConfigOrDefault((li=_w._sydConvConfig)===null||li===void 0?void 0:li.enableSydCarouselHistory,!1),du=SydFSCHelper.getConfigOrDefault((ai=_w._sydConvConfig)===null||ai===void 0?void 0:ai.enableSQMsg,!1,!0),ki=SydFSCHelper.getConfigOrDefault((di=_w._sydConvConfig)===null||di===void 0?void 0:di.enableSemSerpNoCache,!1),nr=SydFSCHelper.getConfigOrDefault((dr=_w._sydConvConfig)===null||dr===void 0?void 0:dr.enableSydStaticAdsLink,!1),es=SydFSCHelper.getConfigOrDefault((gr=_w._sydConvConfig)===null||gr===void 0?void 0:gr.hideSydReconnect,!1),os=(nu=_w._sydConvConfig)===null||nu===void 0?void 0:nu.enableDlBing,ss=(ru=_w._sydConvConfig)===null||ru===void 0?void 0:ru.disableSydGhosting,gs=SydFSCHelper.getConfigOrDefault((fu=_w._sydConvConfig)===null||fu===void 0?void 0:fu.disableCibNotificationStyleUpdate,!1),nh=_w._sydCachedString,wo=_w._sydAddOptionsSet,_G[SydFSCHelper.SYD_MODE]="serp",_G[SydFSCHelper.SYD_PREV_MODE]="",yi=SydFSCHelper.getConfigOrDefault((eu=_w._sydConvConfig)===null||eu===void 0?void 0:eu.keyboardNavigationSydney,!1),wt=SydFSCHelper.getConfigOrDefault((ou=_w._sydConvConfig)===null||ou===void 0?void 0:ou.disableTabletScroll,!1),bt=SydFSCHelper.getConfigOrDefault((su=_w._sydConvConfig)===null||su===void 0?void 0:su.disableTouchDesktopScroll,!1),kt=SydFSCHelper.getConfigOrDefault((hu=_w._sydConvConfig)===null||hu===void 0?void 0:hu.disableDesktopScroll,!1,!0),tr=SydFSCHelper.getConfigOrDefault((cu=_w._sydConvConfig)===null||cu===void 0?void 0:cu.enableChatScrollFix,!1,!0),ir=SydFSCHelper.getConfigOrDefault((vu=_w._sydConvConfig)===null||vu===void 0?void 0:vu.enableModalScrollFix,!1),gt=SydFSCHelper.getConfigOrDefault((yu=_w._sydConvConfig)===null||yu===void 0?void 0:yu.enableConvModeSwitchAjax,!1),er=SydFSCHelper.getConfigOrDefault((pu=_w._sydConvConfig)===null||pu===void 0?void 0:pu.enableCssSplitConvModeOnClick,0),it=SydFSCHelper.getConfigOrDefault((wu=_w._sydConvConfig)===null||wu===void 0?void 0:wu.chatBackgroundColorOverride,""),pr=SydFSCHelper.getConfigOrDefault((bu=_w._sydConvConfig)===null||bu===void 0?void 0:bu.chatBackgroundColorOverrideNoSerp,!1),lt=SydFSCHelper.getConfigOrDefault((nf=_w._sydConvConfig)===null||nf===void 0?void 0:nf.enableWelcomeScreenV2,!1),ct=SydFSCHelper.getConfigOrDefault((tf=_w._sydConvConfig)===null||tf===void 0?void 0:tf.enableWelcomeScreenV3,!1),si=SydFSCHelper.getConfigOrDefault((uf=_w._sydConvConfig)===null||uf===void 0?void 0:uf.enableGptHomeScreen,!1),hi=SydFSCHelper.getConfigOrDefault((ff=_w._sydConvConfig)===null||ff===void 0?void 0:ff.enableChatFRE,!1),or=SydFSCHelper.getConfigOrDefault((ef=_w._sydConvConfig)===null||ef===void 0?void 0:ef.enable2TQueryConfigsOnSerpLoad,!1),sr=SydFSCHelper.getConfigOrDefault((sf=_w._sydConvConfig)===null||sf===void 0?void 0:sf.enableBackgroundFix,!1,!0),hr=SydFSCHelper.getConfigOrDefault((hf=_w._sydConvConfig)===null||hf===void 0?void 0:hf.hideMuidUpsell,!1),cr=SydFSCHelper.getConfigOrDefault((cf=_w._sydConvConfig)===null||cf===void 0?void 0:cf.enableSERPHideShowConv,!1),lr=SydFSCHelper.getConfigOrDefault((lf=_w._sydConvConfig)===null||lf===void 0?void 0:lf.enableBceBcbToggle,!1),s=SydFSCHelper.getConfigOrDefault((af=_w._sydConvConfig)===null||af===void 0?void 0:af.enableNotebookMode,!1),ar=SydFSCHelper.getConfigOrDefault((vf=_w._sydConvConfig)===null||vf===void 0?void 0:vf.enableNotebookScrollDown,!1,!0),vr=SydFSCHelper.getConfigOrDefault((gf=_w._sydConvConfig)===null||gf===void 0?void 0:gf.enableSydTestCache,!1),tt=SydFSCHelper.getConfigOrDefault((ne=_w._sydConvConfig)===null||ne===void 0?void 0:ne.enableChatContAfterHeader,!1),yr=SydFSCHelper.getConfigOrDefault((ie=_w._sydConvConfig)===null||ie===void 0?void 0:ie.enableSafeChatAnsStyle,!1),yo=SydFSCHelper.getConfigOrDefault((re=_w._sydConvConfig)===null||re===void 0?void 0:re.isCopilotChat,!1),hs=SydFSCHelper.getConfigOrDefault((ee=_w._sydConvConfig)===null||ee===void 0?void 0:ee.enableCopilotChatIdentityDisplay,!1),e=SydFSCHelper.getConfigOrDefault((oe=_w._sydConvConfig)===null||oe===void 0?void 0:oe.isNewBingChat,!1),wr=SydFSCHelper.getConfigOrDefault((se=_w._sydConvConfig)===null||se===void 0?void 0:se.isMobileHost,!1)&&(yo||e),br=SydFSCHelper.getConfigOrDefault((he=_w._sydConvConfig)===null||he===void 0?void 0:he.enableFakeScrollTelemetry,!1),ni=SydFSCHelper.getConfigOrDefault((ce=_w._sydConvConfig)===null||ce===void 0?void 0:ce.enableBingChatPath,!1),kr=SydFSCHelper.getConfigOrDefault((le=_w._sydConvConfig)===null||le===void 0?void 0:le.redirectAllChatEntryPointsToNCP,!1),gu=SydFSCHelper.getConfigOrDefault((ae=_w._sydConvConfig)===null||ae===void 0?void 0:ae.enableFixScrollBackSerpAccidentally,!1,!0),bo=SydFSCHelper.getConfigOrDefault((ve=_w._sydConvConfig)===null||ve===void 0?void 0:ve.isGptCreator,!1),cs=SydFSCHelper.getConfigOrDefault((ye=_w._sydConvConfig)===null||ye===void 0?void 0:ye.disableGptCreatorFileUploadOptionsSets,!1),ls=SydFSCHelper.getConfigOrDefault((pe=_w._sydConvConfig)===null||pe===void 0?void 0:pe.disableBotGreeting,!1),b=_d.createElement("slot"),b.setAttribute("name","firstAnswer"),b.setAttribute("slot","firstAns"),k=_d.createElement("slot"),k.setAttribute("name","firstAns"),o=((we=_d.getElementsByClassName("b_top"))===null||we===void 0?void 0:we.length)>0?_d.getElementsByClassName("b_top")[0]:null,ht=!o?!1:o.getElementsByClassName("b_wpt_ch").length>0||o.getElementsByClassName("qna-sydney").length>0,tt?i&&Lib.CssClass.add(sj_b,au):(ko=_ge("b_header"),i&&ko&&sj_b.insertBefore(i,ko)),r=_d.createElement("div"),r===null||r===void 0?void 0:r.setAttribute("slot","firstAnswer"),r===null||r===void 0?void 0:r.setAttribute("id","sydFirstAnswer"),r.style.maxWidth="648px",!!(yo||e||bo))?[3,2]:[4,SydFSCHelper.setConvTranslationAsync()];case 1:ih.sent();ih.label=2;case 2:if(SydFSCHelper.setConfigs(u),SydFSCHelper.setEventListeners(),SydFSCHelper.setSydFSCEligibleState(!0),po=SydFSCHelper.getConfigOrDefault((be=_w._sydConvConfig)===null||be===void 0?void 0:be.isCompliantSydneyEndpointEnabled,!1),po&&(MsbSydneyHelper.setCompliantSydneyUrls(),CIB.responseTone=undefined),bo?(CIB.manager.chat.api.bing._endpoint=window.document.location.origin,CIB.setGptCreatorMode(),ti(i),CIB.config.sydney.request.optionsSets=["nlu_direct_response_filter","deepleo","enable_debug_commands","disable_emoji_spoken_text","responsible_ai_policy_235","enablemm","dv3sugg","autosave","iyxapbing","iycapbing","pluginval","eredirecturl","flux_phone_beta","clgalileo","gencontentv3","flux_botbuilder_base",],cs&&CIB.config.fileupload&&(CIB.config.fileupload.extraOptionsSet=[],CIB.config.fileupload.extraOptionsSetV2=[])):yo?(po||(CIB.manager.chat.api.bing._endpoint=window.document.location.origin),ti(i)):e?ti(i):t=CIB.insertAt(i),hs&&(go=_ge("id_l"),go&&(go.style.display="inline-block")),SydFSCHelper.setColorScheme(),ns=SydFSCHelper.getConfigOrDefault((ke=_w._sydConvConfig)===null||ke===void 0?void 0:ke.isBingChatForEnterprise,!1),ts=SydFSCHelper.getConfigOrDefault((de=_w._sydConvConfig)===null||de===void 0?void 0:de.enableBCEDynamicPrompts,!1),th=SydFSCHelper.getConfigOrDefault((ge=_w._sydConvConfig)===null||ge===void 0?void 0:ge.enableThreads,!1),as=SydFSCHelper.getConfigOrDefault((no=_w._sydConvConfig)===null||no===void 0?void 0:no.enableFreeSydney,!1),vs=ns&&!ts&&typeof BceSydneyHelper!="undefined"?BceSydneyHelper.getSydneyWelcomeCards:undefined,ys=ns&&ts&&typeof BceSydneyHelper!="undefined"?BceSydneyHelper.getFallBackTilesForBCE:undefined,ps=si&&as&&typeof GPTHomeScreen!="undefined",it&&(pr?CIB.theme.addStyles("cib-background",CIB.theme.createStyles(':host([serp-slot="none"][product="bing"][background-type="gradient"]) { background: #'+it+" !important;}")):CIB.theme.addStyles("cib-background",CIB.theme.createStyles(':host([product="bing"][background-type="gradient"]) { background: #'+it+" !important;}"))),ct?ps?GPTHomeScreen===null||GPTHomeScreen===void 0?void 0:GPTHomeScreen.attachPersonaChangeEvents(t):sj_evt.fire("cib_init",t):lt?sj_evt.bind("sydWelcomeScreen",function(){SydWelcomeScreen===null||SydWelcomeScreen===void 0?void 0:SydWelcomeScreen.setContent(t,vs,ys)},!0):hi&&(SydneyChatFRE===null||SydneyChatFRE===void 0?void 0:SydneyChatFRE.setContent(t)),po&&MsbSydneyHelper.addTenantLogoToHeader(),ws=SydFSCHelper.getConfigOrDefault((to=_w._sydConvConfig)===null||to===void 0?void 0:to.useAccountLinkingForConversationLimitUpsell,!1),ws&&(CIB.config.bing.signIn.query.action="acclink",CIB.config.bing.signIn.query.crea="MY04B",CIB.config.bing.signIn.query.pn="AccountLinking_Chat",CIB.config.bing.signIn.query.publ="BingIP"),iu(),os&&CIB.config.sydney.request.optionsSets.push("dlbing"),wo&&CIB.config.sydney.request.optionsSets.push(wo),wi)SydFSCHelper.lastQuery=SydFSCHelper.getQuery().toLowerCase().trim();else{CIB.config.greeting.shouldSendBotGreeting=SydFSCHelper.shouldForceSendBotGreeting;gt||(sj_evt.bind("ajax.unload",function(){SydFSCHelper.shouldResetBotGreeting=!1}),sj_evt.bind("ajax.load",function(){SydFSCHelper.shouldResetBotGreeting=!0}));CIB.onConversationRequestStateChange(function(n){n||CIB.config.greeting.shouldSendBotGreeting||!SydFSCHelper.shouldResetBotGreeting||(CIB.config.greeting.shouldSendBotGreeting=!ls)})}return(gt&&sj_evt.bind("ajax.load",function(){_G[SydFSCHelper.SYD_MODE]="serp"}),bs=SydFSCHelper.getConfigOrDefault((io=_w._sydConvConfig)===null||io===void 0?void 0:io.disResetTT,!1),bs&&(is=(uo=(ro=t===null||t===void 0?void 0:t.shadowRoot)===null||ro===void 0?void 0:ro.querySelector("cib-action-bar"))===null||uo===void 0?void 0:uo.shadowRoot,is&&(lo=sj_ce("style"),lo.textContent="\n                    cib-tooltip {\n                        display: none !important;\n                    }\n                ",is.appendChild(lo))),!(vr&&"SydneyTestHelper"in _w))?[3,4]:[4,SydneyTestHelper===null||SydneyTestHelper===void 0?void 0:SydneyTestHelper.setTestMocks()];case 3:ih.sent();ih.label=4;case 4:if(bi&&(ks=new URLSearchParams(_w.location.search),rs=ks.get("convid"),rs&&ue(rs)),co=(fo=_d.querySelector("cib-serp"))===null||fo===void 0?void 0:fo.shadowRoot,ao=co===null||co===void 0?void 0:co.querySelector("cib-conversation"),ao&&ao.shadowRoot&&(v=ao.shadowRoot.querySelector(".scroller"),lo=sj_ce("style"),es&&(lo.textContent="\n                cib-notification-container {\n                    display: none;\n                }\n            "),ao.shadowRoot.appendChild(lo)),ss&&(us=(oo=(eo=co===null||co===void 0?void 0:co.querySelector("cib-action-bar"))===null||eo===void 0?void 0:eo.shadowRoot)===null||oo===void 0?void 0:oo.querySelector(".autosuggest-text"),us&&(us.style.display="none")),fs="ontouchstart"in window||!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,wt&&Log.Log("ClientInst","Codex","TabletScrollDisabled"),fs&&Log.Log("ClientInst","Codex","TouchD"),bt&&Log.Log("ClientInst","Codex","TouchDesktopScrollDisabled"),!l&&!wt&&(!fs||!bt)&&(sj_be(_w,"mousewheel",wf),sj_be(_w,"touchstart",bf),sj_be(_w,"touchmove",kf),sj_be(_w,"touchend",df),Log.Log("ClientInst","Codex","BindedScrollEvents"),tr&&(vo=(so=_d.querySelector("cib-serp"))===null||so===void 0?void 0:so.shadowRoot.querySelector("cib-side-panel"),vo&&sj_be(vo,"mouseenter",yf),vo&&sj_be(vo,"mouseleave",pf)),ir&&CIB.onModalVisibilityChanged))CIB.onModalVisibilityChanged(function(n){rr=n});SydFSCHelper.triggerShareFlow();tu();sj_evt.bind("ajax.load",tu);h&&(SydFSCHelper.setupHistory(),SydFSCHelper.checkInitialState());rf();l&&te();SydFSCHelper.triggerClarity();CIB.onResetConversation(function(){SydFSCHelper.shouldMove1TAnswers(nt,y)&&uu()});CIB.onModeChanged(function(n){sj_evt.fire("onModeChanged",n)});if(CIB.onMobileUpsellPopupShown)CIB.onMobileUpsellPopupShown(function(){var n={convId:CIB.manager.conversation.id,responseTone:CIB.responseTone};SydFSCHelper.SydLog("SystemEvent","MobileUpsell","MobileUpsellPopupShown",n);SydFSCHelper.createRequest("sydchat/writeConvInfo",JSON.stringify(n))});return ds=((ho=_w.BingChatCustomGreetingString)===null||ho===void 0?void 0:ho.length)>0,ur&&!ds&&SydFSCHelper.processCachedResponseUsingCIB(JSON.parse(fr)),sr&&SydFSCHelper.updateChatBackgroundWidth(),hr&&SydFSCHelper.hideSignInUpsellFor3P(),wr&&SydFSCHelper.hideTopFade(),fe(),typeof SydneyTruncateIdName!="undefined"&&SydneyTruncateIdName.initTruncateIdName&&SydneyTruncateIdName.initTruncateIdName(),[2]}})})}function nf(){ct?sj_evt.fire("renderWsSlot",t):lt&&(SydWelcomeScreen===null||SydWelcomeScreen===void 0?void 0:SydWelcomeScreen.addWelcomeContainerChildSlot(t))}function tf(){var n=_ge("b_content");sb_st(function(){n&&Lib.CssClass.contains(n,"b_showconv")&&Lib.CssClass.remove(n,"b_showconv")},0)}function nu(){var i=_ge("b-scopeListItem-web"),t,n;i&&_d&&(t="\n                .b_scopebar #b-scopeListItem-web {\n                    visibility: visible;\n                }\n\n                body:not(.b_notebookMode) #b-scopeListItem-conv::after {\n                    opacity: 0;\n                }\n\n                .b_notebookMode nav.b_scopebar li.b_active#b-scopeListItem-notebook::after {\n                    opacity: 0;\n                }\n            ",n=_d.createElement("style"),n.setAttribute("type","text/css"),_d.head.appendChild(n),n.innerHTML=t);sj_evt.unbind("ajaxReady",nu)}function ti(n){var i=sj_ce("div");t=CIB.insertAt(i);CIB.showConversation();n.appendChild(t)}function tu(){sj_evt.bind("hideSydFSC",function(n){var k,d,it,o,i,r,v,g,u,f,t,e,b;if(!vt){if(vt=!0,Log.Log("ClientInst","Codex","LeaveConversationMode"),c||(Lib.CssClass.remove(sj_b,a),it=_ge("tallhead"),it&&(dr?_w.scrollTo(0,0):_w.scrollBy(0,48))),tt&&sb_st(function(){if(!Lib.CssClass.contains(sj_b,a)){var n=_ge("b_header"),t=_d.querySelector(".b_scopebar");t&&(n===null||n===void 0?void 0:n.insertBefore(t,li))}},1e3),o=_ge("sb_form"),o&&Lib.CssClass.contains(o,"hassbi")&&Lib.CssClass.remove(o,"hassbi"),CIB.hideConversation(),c||l||(Lib.CssClass.add(_d.documentElement,"b_delayOvflw"),SydFSCHelper.shouldMove1TAnswers(nt,y)&&uu(),i=_ge("b-scopeListItem-web"),i&&i.children.length>0&&(i.children[0].setAttribute("aria-current","page"),Lib.CssClass.add(i,"b_active"),((k=_G===null||_G===void 0?void 0:_G.EF)===null||k===void 0?void 0:k.chatskip2content)===1||((d=_ge("b_skip_to_content"))===null||d===void 0?void 0:d.setAttribute("tabindex","0"))),r=_ge("b-scopeListItem-conv"),r&&r.children.length>0&&(r.children[0].setAttribute("aria-current","false"),Lib.CssClass.remove(r,"b_active")),v=_ge("b_phead_chat"),v&&Lib.CssClass.contains(v,"b_active")&&Lib.CssClass.remove(v,"b_active")),_G[SydFSCHelper.SYD_PREV_MODE]!=_G[SydFSCHelper.SYD_MODE]&&(_G[SydFSCHelper.SYD_PREV_MODE]=_G[SydFSCHelper.SYD_MODE],h&&(g=n&&n.length>1?n[1]:!1,g&&SydFSCHelper.LogIntEvent("ConversationViewExit","Conversation",{source:"BackButton"}),g||SydFSCHelper.pushSydHistory(!1))),!h&&st&&SydFSCHelper.updateConvFlagInURL(!1),SydFSCHelper.updateConvPageTitle(!1),_G[SydFSCHelper.SYD_MODE]="serp",yt){if(u=_ge("b_pole"),!u){for(u=sj_ce("div","b_pole"),f=_d.querySelector("main"),t=_ge("b_results");t&&f&&t.parentElement!=f;)t=t.parentElement;f&&t&&f.insertBefore(u,t)}SydFSCHelper.addCarousel(u)}else if(vi&&(e=CIB.vm.conversation.model.messages.filter(function(n){return n.type==="meta"&&n.text!="Generating answers for you..."||n.type==="text"&&n.author==="user"}),e&&e.length>0)){var p=e[e.length-1].text.split("`"),w=p.length==1?p[0]:p.length==3?p[1]:"",rt=_ge("sb_form_go"),ut=_ge("sb_form_q");_w.sj_isAjax&&w&&ut.value.toLowerCase()!=w.toLowerCase()&&rt&&(ut.value=w,SydFSCHelper.lastQuery=w,rt.click())}s&&sj_evt.fire("switchToWeb");sj_ue(_w,"beforeprint",eu);sj_ue(_w,"afterprint",ou);b=_ge("b_content");b&&Lib.CssClass.contains(b,"b_hide")&&Lib.CssClass.remove(b,"b_hide");hu(!1);vt=!1}});sb_st(function(){yr||(sj_evt.bind("showSydFSC",af,!0),s&&sj_evt.bind("showNotebook",function(){var n,i,r;sj_evt.fire("switchToNotebook");SydFSCHelper.setNotebookOptions();SydFSCHelper.addNotebookFlagInURL();SydFSCHelper.getConfigOrDefault((n=_w._sydConvConfig)===null||n===void 0?void 0:n.enableSetNotebookAlignment,!1,!0)&&t.setAttribute("alignment","left");r=SydFSCHelper.getConfigOrDefault((i=_w._sydConvConfig)===null||i===void 0?void 0:i.enableLoopNotebook,!1);r&&sj_evt.fire("setupNotebookLoop")},!0))},0);cr&&sj_evt.bind("sydFSCLoaded",tf,!0);e&&sj_evt.bind("ajaxReady",nu,!0);sj_evt.bind("onModeChanged",function(n){setTimeout(function(){var t;s&&_G[SydFSCHelper.SYD_PREV_MODE]==="notebook"&&n[1]!=="notebook"&&(SydFSCHelper.setDefaultOptions(),nf(),SydFSCHelper.getConfigOrDefault((t=_w._sydConvConfig)===null||t===void 0?void 0:t.enableSetNotebookAlignment,!1,!0)&&iu())},0)});sj_evt.fire("convInit:done")}function iu(){var n,i,r,u,e=SydFSCHelper.getConfigOrDefault((n=_w._sydConvConfig)===null||n===void 0?void 0:n.isCopilotChat,!1),o=SydFSCHelper.getConfigOrDefault((i=_w._sydConvConfig)===null||i===void 0?void 0:i.enableThreads,!1),f=SydFSCHelper.getConfigOrDefault((r=_w._sydConvConfig)===null||r===void 0?void 0:r.enableChatCenterAlign,!1),s=e&&!o||f;t.setAttribute("alignment",s?"center":"left");f&&((u=t===null||t===void 0?void 0:t.style)===null||u===void 0?void 0:u.setProperty("--cib-comp-conversation-max-width","840px"))}function ru(){var t;o=((t=_d.getElementsByClassName("b_top"))===null||t===void 0?void 0:t.length)>0?_d.getElementsByClassName("b_top")[0]:null;oi=sj_b.querySelector("#b_sydTigerCont")!=null;ht=!!o&&o.querySelector("#sydwrap_wrapper")!=null;n.moveOnlySydXAnswers&&(u=sj_b.querySelector("#sydwrap_wrapper #b_syd_sm_chat .b_wpt_chat"),u&&(Lib.CssClass.add(u,ci),di=u.querySelector(".b_wpt_creator_content")!=null))}function rf(){var n=_ge("id_hbfo");sj_be(n,"click",function(n){var r=n.target,t,i;_G[SydFSCHelper.SYD_MODE]=="conversation"&&r&&(t=uf(r),t&&t.target!="_blank"&&(i="",t.href.indexOf("/profile/")>=0?i="profile":t.href.indexOf("/account/")>=0&&(i="account"),SydFSCHelper.LogIntEvent("ConversationViewExit","Conversation",{source:"ClickMenu",target:i})))})}function uf(n){while(n!=null){if(n.tagName=="A"&&Lib.CssClass.contains(n,"hb_section"))return n;n=n.parentElement}return null}function ii(n,t,i){i===void 0&&(i=!1);t&&n&&(i?n.prepend(t):n.appendChild(t))}function ff(n){var u,f,e,o,s,h;if(!ui){ii(_ge("b_sydtoporpole"),n);return}var l=_d.querySelector("cib-serp"),t=(f=(u=_d.querySelector("cib-serp"))===null||u===void 0?void 0:u.shadowRoot)===null||f===void 0?void 0:f.querySelector("cib-conversation"),i=(o=(e=t===null||t===void 0?void 0:t.shadowRoot)===null||e===void 0?void 0:e.querySelector(".scroller"))===null||o===void 0?void 0:o.querySelector(".main cib-welcome-container"),c=(h=(s=t===null||t===void 0?void 0:t.shadowRoot)===null||s===void 0?void 0:s.querySelector(".scroller"))===null||h===void 0?void 0:h.querySelector(".main");t===null||t===void 0?void 0:t.appendChild(b);i?i===null||i===void 0?void 0:i.after(k):c===null||c===void 0?void 0:c.prepend(k);r===null||r===void 0?void 0:r.appendChild(n);ei;ii(l,r);ef()}function ef(){sf();hf()}function sf(){var t=_d.querySelector("#sydFirstAnswer .b_wpt_chat"),n=_d.querySelector("#sydFirstAnswer .b_wpt_chat .b_wpt_chat_inner");t&&n&&(t.querySelector("b_wpt_chat_inner > .b_sideBleed")&&(n.style.padding="0 20px 5px 20px"),t.querySelector(".b_wpt_chat_inner > .wtr_core.b_sideBleed, .b_wpt_chat_inner > .b_sideBleed #lMapContainer, .b_wpt_chat_inner > .ji_container, .b_wpt_chat_inner > .b_sideBleed #placeAnswer, .b_wpt_chat_inner > .b_sideBleed .ckt_main, .b_wpt_chat_inner > .b_sideBleed .mit_ans, .b_wpt_chat_inner > .jobsAnswerContainer, .b_wpt_chat_inner > div .sa_main")&&(n.style.padding="unset"),n.querySelector(".b_wpt_creator")&&(n.style.padding="0px"),n.querySelector(".b_wpt_insights")&&(n.style.paddingTop="0px",n.style.paddingBottom="0px"))}function hf(){var n=_d.querySelector("#sydFirstAnswer .b_wpt_chat");n&&n.querySelector(".b_wpt_creator")&&(n.style.boxShadow="unset")}function cf(){if(ru(),n.moveOnlySydXAnswers){if(!u||gi&&di)return;(y||ht&&!oi)&&sb_st(function(){ff(u)},pu)}}function uu(){if(n.moveOnlySydXAnswers){if(!u)return;var t=sj_b.querySelector("#sydwrap_wrapper #b_syd_sm_chat");t&&!t.contains(u)&&u&&(Lib.CssClass.remove(u,ci),ii(t,u,!0))}}function fu(){var n=new URLSearchParams(_w.location.search),t=n.get("sendquery");return t==="1"}function lf(){var n=_ge("conv-css-link");n&&!n.classList.contains("css-conv-added")&&(n.setAttribute("rel","stylesheet"),n.setAttribute("class","css-conv-added"))}function af(n){var b,k,d,g,it,rt,ft,et,ot,ht,ct,lt,vt,pt,wt,bt=!1,oi,dt,t,gt,u,si,f,p,ii,ri,o,r,ei;if(SydFSCHelper.getConfigOrDefault((b=_w._sydConvConfig)===null||b===void 0?void 0:b.enableshowSydFSCThrottle,!1)&&_G[SydFSCHelper.SYD_MODE]==="conversation"){var kt=n&&n.length>1?n[1]:null,pi=n&&n.length>2?n[2]:null,wi=n&&n.length>3?n[3]&&n[3]!=="":!1,bi=n&&n.length>5?n[5]:null,di=n&&n.length>7?n[7]:!1,gi=n&&n.length>8?n[8]:!1,nr=n&&n.length>9?n[9]:!1;SydFSCHelper.getConfigOrDefault((k=_w._sydConvConfig)===null||k===void 0?void 0:k.enableAlwaysSendMsg,!1)&&nr&&kt&&(bt=SydFSCHelper.sendFirstQuery(gi?kt.trim():kt.toLowerCase().trim(),pi,bi,di||fu(),wi));return}if(!at){if(at=!0,SydFSCHelper.updateResponseToneAfterSerp(),oi=SydFSCHelper.getConfigOrDefault((d=_w._sydConvConfig)===null||d===void 0?void 0:d.disableAllChatAds,!1),CIB.config.features.enableAds=!oi,ki&&(dt=CIB.config.sydney.request.optionsSets.indexOf("nocacheread"),dt>=0&&CIB.config.sydney.request.optionsSets.splice(dt,1)),er&&lf(),_w.scrollY==0&&(dr=!0),t=_ge("b_header"),gt=!1,t&&ut&&Lib.CssClass.contains(t,ut)&&(Lib.CssClass.remove(t,ut),SydFSCHelper.getConfigOrDefault((g=_w._sydConvConfig)===null||g===void 0?void 0:g.enableShareLinkTrackLog,!1)?(u=new URLSearchParams(window.location.search),si=!!u.get("shareId")&&!!u.get("shid"),SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:si?"ShareLink":"ShowConv"})):SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ShowConv"}),s)){var u=new URLSearchParams(window.location.search),tr=SydFSCHelper.getConfigOrDefault((it=_w._sydConvConfig)===null||it===void 0?void 0:it.disableShareLinkShowntbk,!1),ir=!!u.get("shareId");gt=tr&&ir?!1:u.get("showntbk")==="1"}t&&!Lib.CssClass.contains(t,"b_bcbSwitch")&&lr&&Lib.CssClass.add(t,"b_bcbSwitch");yt&&SydFSCHelper.removeQueries();f=n&&n.length>1?n[1]:null;p=n&&n.length>2?n[2]:null;y=n&&n.length>3?n[3]==yu:!1;var hi=n&&n.length>3?n[3]&&n[3]!=="":!1,rr=n&&n.length>3?(rt=n[3])!==null&&rt!==void 0?rt:"":"",ni=n&&n.length>5?n[5]:null,ur=n&&n.length>6?n[6]:!1,e=n&&n.length>7?n[7]:!1,fr=n&&n.length>8?n[8]:!1,ti=n&&n.length>10?n[10]:!0;if(c||l||(_w.scrollY>0&&_w.scrollTo(0,0),_d.documentElement&&(Lib.CssClass.add(_d.documentElement,"b_disOvflw"),Lib.CssClass.remove(_d.documentElement,"b_delayOvflw"))),c||(Lib.CssClass.add(sj_b,a),tt&&sb_st(function(){if(Lib.CssClass.contains(sj_b,a)){var i=_ge("id_h"),n=_d.querySelector(".b_scopebar");li=n&&n.nextSibling;i&&n&&(t===null||t===void 0?void 0:t.insertBefore(n,i))}},1e3)),SydFSCHelper.shouldMove1TAnswers(nt,y,f)&&cf(),f&&(ii=SydFSCHelper.getConfigOrDefault((ft=_w._sydConvConfig)===null||ft===void 0?void 0:ft.enableSendQueryTextMessage,!1,!0),ri=fu(),ti=ti&&!(ri&&ii),e=e||ri&&!ii,bt=SydFSCHelper.sendFirstQuery(fr?f.trim():f.toLowerCase().trim(),p,ni,e,hi,ti),hi&&SydFSCHelper.LogIntEvent("EnteredToChatFromSerpChips",rr,"")),CIB.showConversation(),ur&&(o=[],ni&&o.push({author:"user",text:ni}),p&&o.push({author:"bot",text:p}),fi&&o.length!=0&&CIB.registerContext(o),CIB.toggleSpeechEnabled(),CIB.triggerMic()),!c&&!l){r=_ge("b-scopeListItem-web");r&&r.children.length>0&&r.parentElement&&(r.children[0].setAttribute("aria-current","false"),Lib.CssClass.remove(r,"b_active"));var w=_ge("b-scopeListItem-conv"),ui=_ge("b_bceBcbToggle"),ci=ui===null||ui===void 0?void 0:ui.querySelector(".selected");if(w&&w.children.length>0&&(w.children[0].setAttribute("aria-current","page"),Lib.CssClass.add(w,"b_active"),((et=_G===null||_G===void 0?void 0:_G.EF)===null||et===void 0?void 0:et.chatskip2content)===1||((ot=_ge("b_skip_to_content"))===null||ot===void 0?void 0:ot.setAttribute("tabindex","-1")),ci&&e&&ci.focus(),yi)){var v=_d.querySelector(".b_sydConvMode"),ai=v&&((wt=(pt=(vt=(lt=(ct=(ht=v===null||v===void 0?void 0:v.querySelector("cib-serp"))===null||ht===void 0?void 0:ht.shadowRoot)===null||ct===void 0?void 0:ct.querySelector("cib-action-bar"))===null||lt===void 0?void 0:lt.shadowRoot)===null||vt===void 0?void 0:vt.querySelector(".input-container").querySelector("cib-text-input"))===null||pt===void 0?void 0:pt.shadowRoot)===null||wt===void 0?void 0:wt.querySelector("textarea")),vi=_d.documentElement;v&&ai&&!e&&ai.focus();vi&&i&&t&&sj_be(vi,"keydown",function(n){Log&&Log.Log("Info","Accessibility","KeyboardNavigationSydney");(n.code=="Tab"||n.keyCode==9||n.key=="Tab")&&(i.contains(n.target||n.srcElement)||t.contains(n.target||n.srcElement)||(i.tabIndex=0,i.focus()))})}}_G[SydFSCHelper.SYD_PREV_MODE]!=_G[SydFSCHelper.SYD_MODE]&&(_G[SydFSCHelper.SYD_PREV_MODE]=_G[SydFSCHelper.SYD_MODE],h&&(ei=n&&n.length>4?n[4]:!1,ei&&SydFSCHelper.LogIntEvent("ConversationViewEnter","Conversation",{source:"BackButton"}),ei||SydFSCHelper.pushSydHistory(!0)));!h&&st&&SydFSCHelper.updateConvFlagInURL(!0);SydFSCHelper.updateConvPageTitle(!0);or||vf();_G[SydFSCHelper.SYD_MODE]="conversation";!bt&&CIB.config.features.enablePartnerVisualSearchUpload&&SydFSCHelper.submitVisualSearchImage();gt&&sj_evt.fire("switchToNotebook");sj_be(_w,"beforeprint",eu);sj_be(_w,"afterprint",ou);hu(!0);at=!1}}function vf(){var n=ClientObserver.getBrowserWidth(),t=ClientObserver.getBrowserHeight();SydFSCHelper.set2TQueryConfigs(n,t,nr)}function yf(){dt=!0}function pf(){dt=!1}function wf(n){var t=0;n||(n=window.event);n.wheelDelta?t=n.wheelDelta/60:n.detail&&(t=-n.detail/2);su(t,ft)}function bf(n){pt=n.changedTouches[0].clientY;w=n.touches&&n.touches.length>1?!0:!1}function kf(n){var t=n.changedTouches[0].clientY-pt;su(t,vu,!0)}function df(n){f=0;d=!1;g=!1;pt=0;w=n.touches&&n.touches.length!==0}function eu(){var n=_ge("b_content");n&&Lib.CssClass.add(_ge("b_content"),"b_hide")}function ou(){var n=_ge("b_content");n&&Lib.CssClass.remove(n,"b_hide")}function su(n,t,i){var o,h,c,l,r,u,y,b;if(i===void 0&&(i=!1),Log.Log("ClientInst","Codex","CheckScrollCalled"),!dt&&!rr){if(sb_ct(ai),d||(p=Lib.CssClass.contains(sj_b,a),g=p?ne():_w.scrollY==0),d=!0,g&&(f+=n),i||(ai=sb_st(function(){f=0;d=!1;g=!1},150)),r=!p&&f>et&&_G[SydFSCHelper.SYD_MODE]!="conversation"&&!w,u=ot&&p&&f<-1*et&&_G[SydFSCHelper.SYD_MODE]=="conversation"&&!w,r=ni&&kr?r&&Lib.CssClass.contains(sj_b,"b_sydStandalone"):r,s&&!u){var k=SydFSCHelper.getConfigOrDefault((o=_w._sydConvConfig)===null||o===void 0?void 0:o.enableNotebookInputBoxScroll,!1),v=(c=(h=_d.querySelector("cib-serp"))===null||h===void 0?void 0:h.shadowRoot)===null||c===void 0?void 0:c.querySelector("cib-action-bar"),nt=k&&((l=v===null||v===void 0?void 0:v.shadowRoot)===null||l===void 0?void 0:l.querySelector(".root").hasAttribute("focus"));u=ot&&p&&f<-1*et&&_G[SydFSCHelper.SYD_MODE]=="notebook"&&!w&&!nt}r?(Log.Log("ClientInst","Codex","ScrollToChat"),!kt&&f>t&&(br?SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ChatBubble"}):SydFSCHelper.LogIntEvent("ConversationViewEnter","Scope",{source:"ScrollUp"}),SydFSCHelper.triggerSydFSCQueryWithContext("","",!1))):u&&(Log.Log("ClientInst","Codex","ScrollOutChat"),y=s&&_G[SydFSCHelper.SYD_MODE]==="notebook",b=!y||y&&ar,!kt&&b&&f<-1*t&&(e&&!gf()?sj_evt.bind("ajaxReady",ri,!0):ri()))}}function gf(){var n=_ge(wu);return n&&!Lib.CssClass.contains(n,bu)}function ri(){e&&SydFSCHelper.isCookieBannerVisibileOnChatPage()||(SydFSCHelper.LogIntEvent("ConversationViewExit","Scope",{source:"ScrollDown",target:_G[SydFSCHelper.SYD_PREV_MODE]}),sj_evt.fire("hideSydFSC"),sb_st(function(){_w.scrollTo(0,0)},1),(e||ni)&&sj_evt.unbind("ajaxReady",ri))}function ne(){return!v?!1:Math.abs(v.scrollTop-(v.scrollHeight-v.offsetHeight))<1}function te(){var t,i,r,e=_ge("b_sydOvrClose"),n,u,f;e&&sj_be(e,"click",function(){sj_evt.fire("hideSydFSC")});n=(r=(i=(t=_d.querySelector("#b_sydConvCont cib-serp"))===null||t===void 0?void 0:t.shadowRoot)===null||i===void 0?void 0:i.querySelector("cib-action-bar"))===null||r===void 0?void 0:r.shadowRoot;u=n===null||n===void 0?void 0:n.querySelector(".outside-left-container");u&&(u.style.display="none");pi&&n&&(f=sj_ce("style"),f.textContent="\n                .control.microphone {\n                    display: none;\n                }\n            ",n.appendChild(f))}function ie(n){var i,r,t=_ge("id_rfob");n&&((i=t===null||t===void 0?void 0:t.style)===null||i===void 0?void 0:i.display)?t.style.display="none":undefined;!n&&((r=t===null||t===void 0?void 0:t.style)===null||r===void 0?void 0:r.display)?t.style.display="inline-flex":undefined}function hu(n){var t,i,r=SydFSCHelper.getConfigOrDefault((t=_w._sydConvConfig)===null||t===void 0?void 0:t.isCompliantSydneyEndpointEnabled,!1),u=SydFSCHelper.getConfigOrDefault((i=_w._sydConvConfig)===null||i===void 0?void 0:i.isBingChatForEnterprise,!1);(r||u)&&ie(n)}function re(n,t){var i,r;n===void 0&&(n=null);t===void 0&&(t=ft);r=(i=_w._sydPayWallConfig)===null||i===void 0?void 0:i.loadSydneyConvResWithPayWall;r?sj_evt.bind("waitlistUpdate:eligible",gr,!0):void gr(n);ft=t}function ue(n){CIB.loadConversation(n);SydFSCHelper.lastQuery=SydFSCHelper.getQuery().toLowerCase().trim()}function fe(){var c=this,i,r,u,f,e=(i=_w._sydConvConfig)===null||i===void 0?void 0:i.pluginDevToolsSessionId,o,s,h,t,n;e&&(o=(r=_w._sydConvConfig)===null||r===void 0?void 0:r.pluginDevToolsOrganizationId,o&&(t=new URL("https://vlscppe.microsoft.com/fp/tags.js"),t.searchParams.append("org_id",o),t.searchParams.append("session_id",e),n=document.createElement("script"),n.type="text/javascript",n.src=t.toString(),n.async=!0,document.head.appendChild(n)),s=(u=_w._sydConvConfig)===null||u===void 0?void 0:u.pluginDevToolsDfpInstanceId,h=(f=_w._sydConvConfig)===null||f===void 0?void 0:f.pluginDevToolsDfpPageId,s&&h&&(t=new URL("https://ov-df.microsoft.com/mdt.js"),t.searchParams.append("session_id",e),t.searchParams.append("instanceId",s),t.searchParams.append("pageid",h),n=document.createElement("script"),n.type="text/javascript",n.src=t.toString(),n.async=!0,n.onload=function(){window.dfp.doFpt(c.document)},document.head.appendChild(n)))}var rt,a="b_sydConvMode",ut="b_sydShowConv",lu="b_sydConvCont",au="b_ctf",ft=10,et=10,vu=100,ui,ot,fi,h,st,ei=!1,o,ht,u=null,oi=!1,t,ct,si,lt,hi,v,r,b,k,yu="SYDX_WRAPPER",y=!1,ci="b_sydxwrappedanswer",pu=1e3,at=!1,vt=!1,li=null,wu="b_content",bu="noSecondChunk",f=0,ai,d=!1,g=!1,p=!1,ku=!1,nt=!1,vi=!1,yt=!1,c=!1,l=!1,yi=!1,pt,cu;n.moveOnlySydXAnswers=!1;var pi=!1,wi=!1,bi=!1,du=!1,ki=!1,di=!1,gi=!1,nr=!1,wt=!1,bt=!1,kt=!1,tr=!1,dt=!1,ir=!1,rr=!1,gt=!1,ur=!1,fr="",w=!1,er,or=!1,sr=!1,hr=!1,cr=!1,lr=!1,s=!1,ar=!1,vr=!1,tt=!1,yr=!1,it="",pr=!1,wr=!1,br=!1,e=!1,ni=!1,kr=!1,gu=!1,dr=!1,i;(typeof sj_b=="undefined"||sj_b==null)&&(window.sj_b=document.body);n.init1TAnswerContents=ru;n.initWithWaitlistUpdate=re;cu=SydFSCHelper.getConfigOrDefault((rt=_w._sydConvConfig)===null||rt===void 0?void 0:rt.enableSuperBowlWelcomescreenTest,!1);cu&&typeof WelcomeScreenLoader!="undefined"&&WelcomeScreenLoader.loadWelcomeScreen();sj_evt.fire("sydFSC.init")})(SydneyFullScreenConv||(SydneyFullScreenConv={}))